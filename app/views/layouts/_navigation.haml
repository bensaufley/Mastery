%header.navbar.navbar-fixed-top.navbar-inverse{ role: 'navigation' }
  %nav.container
    .navbar-header
      %button.navbar-toggle{ "data-toggle" => 'collapse', "data-target" => '.navbar-collapse' }
        %span.sr-only Toggle navigation
        %span.icon-bar
        %span.icon-bar
        %span.icon-bar
      =link_to 'mastery', root_path, class: 'navbar-brand'
    .collapse.navbar-collapse
      %ul.nav.navbar-nav.navbar-right
        - if user_signed_in?
          %li.dropdown
            = link_to '#', class: 'dropdown-toggle', title: 'New Activity', data: { toggle: 'dropdown' } do
              %span.glyphicon.glyphicon-plus-sign
              %span New Activity
              %span.caret
            %ul.dropdown-menu{ role: 'menu' }
              %li
                = link_to new_activity_path(current_user, { type: 'timed' }) do
                  %span.glyphicon.glyphicon-time
                  Timed
              %li
                = link_to new_activity_path(current_user, { type: 'counted' }) do
                  %span.glyphicon.glyphicon-ok-circle
                  Counted
          %li.dropdown
            = link_to '#', class: 'dropdown-toggle', data: { toggle: 'dropdown' }, title: 'Track Activity' do
              %span.glyphicon.glyphicon-record
              %span Track Activity
              %span.caret
            %ul.dropdown-menu{ role: 'menu' }
              - if current_user.activities.length > 0
                %li.dropdown-header{role: 'presentation'}
                  %span.glyphicon.glyphicon-time
                  Timed Activities
                - if current_user.timed_activities.length > 0
                  - current_user.timed_activities.each do |activity|
                    %li
                      = link_to activity_path(activity.user,activity) do
                        %span.glyphicon.glyphicon-record
                        =activity.name
                - else
                  %li
                    = link_to new_activity_path(current_user) do
                      %span.glyphicon.glyphicon-time
                      Create timed Activity
                %li.dropdown-header{role: 'presentation'}
                  %span.glyphicon.glyphicon-ok-circle
                  Counted Activities
                - if current_user.counted_activities.length > 0
                  - current_user.counted_activities.each do |activity|
                    %li
                      = link_to activity_path(activity.user,activity) do
                        %span.glyphicon.glyphicon-ok
                        =activity.name
                - else
                  %li
                    = link_to new_activity_path(current_user) do
                      %span.glyphicon.glyphicon-ok-circle
                      Create counted Activity

              - else
                %li.dropdown-header{role: 'presentation'} You do not have any Activities yet.
                %li
                  = link_to new_activity_path(current_user) do
                    %span.glyphicon.glyphicon-plus-sign
                    Create one
          %li
            =link_to edit_user_registration_path, title: 'Edit Account' do
              %span.glyphicon.glyphicon-cog
              ="@#{current_user.username}"
          %li
            =link_to destroy_user_session_path, method: 'delete' do
              %span.glyphicon.glyphicon-log-out
              Sign Out
        - else
          %li.dropdown
            %a.dropdown-toggle{ 'data-toggle' => 'dropdown', href: '#' }
              Login
              %b.caret
              %span.sr-only Toggle Dropdown
            .dropdown-menu.col-md-4
              = form_tag user_session_path, html: { class: 'form-group', role: 'form' } do
                .input-group.form-group
                  .input-group-addon @
                  = text_field_tag 'user[username]', '', placeholder: 'Username', class: 'form-control', size: 35
                .form-group
                  = password_field_tag 'user[password]', '', placeholder: 'Password', class: 'form-control'
                .checkbox
                  %label
                    = check_box_tag 'user[remember_me]'
                    Remember Me
                %button.btn.btn-primary.pull-right Sign in
              %p= link_to "Forgot your password?", new_password_path('user')
          %li=link_to 'Sign Up', root_path